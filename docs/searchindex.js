Search.setIndex({"docnames": ["api", "changelog", "contributing", "examples", "index", "installation", "quickstart", "tutorial"], "filenames": ["api.rst", "changelog.rst", "contributing.rst", "examples.rst", "index.rst", "installation.rst", "quickstart.rst", "tutorial.rst"], "titles": ["API Reference", "Changelog", "Contributing", "Examples", "CITEgeist Documentation", "Installation", "Quick Start", "Tutorial"], "terms": {"thi": [0, 1, 2, 3, 6, 7], "page": [0, 4], "provid": [0, 2, 3, 7], "an": [0, 2], "auto": 0, "gener": 0, "summari": 0, "": [0, 4, 6], "public": 0, "The": [0, 5, 7], "main": [0, 1, 7], "class": [0, 1], "spatial": [0, 1, 3, 4, 6, 7], "transcriptom": [0, 1, 3, 4, 6, 7], "analysi": [0, 1, 4, 6, 7], "citegeist_model": [0, 1, 3, 5, 6], "citegeistmodel": [0, 1, 3, 6, 7], "sample_nam": [0, 3, 6, 7], "adata": [0, 3, 6, 7], "none": 0, "output_fold": [0, 3, 6, 7], "simul": 0, "fals": 0, "gene_expression_adata": 0, "antibody_capture_adata": 0, "sourc": [0, 5], "base": [0, 1], "object": 0, "__repr__": 0, "develop": 0, "friendli": 0, "represent": 0, "__str__": 0, "user": 0, "append_gex_to_adata": 0, "parquet_path": 0, "pass_numb": 0, "1": [0, 6], "append": 0, "gene": [0, 1, 4, 6, 7], "express": [0, 1, 4, 6, 7], "layer": [0, 7], "from": [0, 3, 5, 6], "parquet": 0, "file": [0, 1], "back": 0, "append_proportions_to_adata": 0, "proportions_path": 0, "kei": [0, 4], "finetun": 0, "cell": [0, 1, 3, 4, 6], "type": [0, 1, 2, 3, 4, 6], "proport": [0, 1, 3, 4, 6, 7], "anndata": [0, 7], "cleanup": 0, "free": 0, "memori": 0, "clean": 0, "up": [0, 2], "temporari": 0, "data": [0, 1, 3, 4, 6], "compute_expression_prior": 0, "spotwise_profiles_pass1": 0, "cell_type_numbers_arrai": 0, "lambda_prior": 0, "0": [0, 3, 6, 7], "min_expression_threshold": 0, "comput": [0, 4], "global": 0, "prior": 0, "pass": [0, 2], "result": [0, 3, 4, 6], "paramet": [0, 4], "dict": 0, "int": 0, "ndarrai": 0, "dictionari": 0, "map": [0, 7], "spot": [0, 7], "indic": 0, "profil": [0, 1, 3, 4, 6], "matric": 0, "arrai": 0, "n_spot": 0, "t_celltyp": 0, "float": 0, "strength": [0, 6], "influenc": 0, "default": 0, "minimum": 0, "consid": 0, "activ": 0, "return": 0, "global_prior": 0, "np": 0, "shape": 0, "m_gene": 0, "confidence_scor": 0, "expression_pattern": 0, "contain": 0, "detail": [0, 4, 5, 6], "statist": 0, "str": 0, "ani": 0, "copy_gex_to_protein_adata": 0, "copi": 0, "number": [0, 6], "antibodi": [0, 1, 4, 6, 7], "captur": [0, 1, 4, 6, 7], "filter_gex": [0, 3, 6, 7], "nonzero_percentag": [0, 7], "01": [0, 7], "mean_expression_threshold": [0, 7], "min_count": 0, "10": [0, 3], "filter": [0, 7], "defin": [0, 3, 7], "criteria": 0, "have": 0, "A": [0, 3, 5], "count": [0, 7], "least": 0, "2": [0, 3], "mean": [0, 3], "nonzero": 0, "percentag": 0, "where": [0, 2], "must": 0, "valu": [0, 3], "get_adata": [0, 3], "retriev": 0, "intern": 0, "downstream": 0, "static": 0, "global_clr": 0, "matrix": [0, 7], "epsilon": 0, "1e": 0, "06": 0, "appli": 0, "margin": 0, "clr": 0, "normal": [0, 7], "geometr": 0, "per": 0, "marker": 0, "param": 0, "input": 0, "x": 0, "numpi": [0, 1, 5], "small": 0, "constant": 0, "avoid": 0, "divis": 0, "zero": 0, "load_cell_profile_dict": [0, 3, 6, 7], "cell_profile_dict": 0, "load": [0, 3, 6], "valid": [0, 5], "preprocess_antibodi": [0, 3, 6, 7], "preprocess": [0, 6], "winsor": 0, "extrem": 0, "gaussian": 0, "smooth": 0, "local": [0, 2], "background": 0, "correct": 0, "rais": 0, "error": 0, "nan": 0, "inf": 0, "ar": 0, "detect": 0, "process": [0, 1, 4], "preprocess_gex": [0, 3, 6, 7], "target_sum": [0, 7], "10000": [0, 7], "preserv": 0, "register_gurobi": [0, 3], "license_file_path": 0, "configur": [0, 3], "set": [0, 2], "onli": 0, "licens": [0, 1, 5], "path": [0, 3], "row_norm": 0, "row": 0, "2d": 0, "fix": 0, "target": 0, "sum": 0, "run_cell_expression_pass1": [0, 3, 6, 7], "radiu": [0, 3, 6, 7], "alpha": [0, 3, 6, 7], "5": [0, 3, 7], "lambda_reg_gex": 0, "001": 0, "global_enrichment_weight": 0, "local_enrichment_weight": 0, "max_work": [0, 6], "checkpoint_interv": 0, "100": [0, 3], "output_dir": 0, "checkpoint": [0, 1], "rerun": 0, "true": 0, "run": [0, 1, 3, 6], "first": 0, "deconvolut": [0, 1, 6, 7], "neighbor": 0, "weight": 0, "regular": [0, 1, 6], "enrich": 0, "option": 0, "maximum": 0, "parallel": [0, 1, 6], "worker": [0, 6], "between": 0, "directori": 0, "bool": 0, "whether": 0, "exist": [0, 2], "spotwise_profil": 0, "dimens": 0, "tupl": 0, "run_cell_proportion_model": [0, 3, 6, 7], "toler": 0, "0001": 0, "max_iter": 0, "20": 0, "lambda_reg": [0, 3, 6, 7], "max_y_chang": 0, "4": 0, "orchestr": 0, "optim": [0, 1, 3, 5, 6], "workflow": [0, 2, 3, 4], "deleg": 0, "optimize_cell_proport": 0, "finetune_cell_proport": 0, "gurobi_impl": [0, 1], "py": 0, "converg": 0, "em": 0, "algorithm": 0, "iter": 0, "l1": [0, 6], "l2": [0, 6], "tradeoff": [0, 6], "factor": [0, 6], "dure": 0, "split_adata": [0, 3, 6, 7], "split": [0, 6], "separ": [0, 7], "sub": 0, "feature_typ": [0, 7], "var": [0, 7], "validate_neighborhood_s": 0, "lower_percentil": 0, "upper_percentil": 0, "95": 0, "core": [0, 1], "function": [0, 1, 2], "us": [0, 1, 2, 3, 5, 6, 7], "solver": 0, "compute_global_prior": 0, "spotwise_gene_expression_profil": 0, "pattern": 0, "confid": 0, "each": [0, 7], "deconvolute_local_cell_proport": 0, "spot_idx": 0, "profile_based_antibody_data": 0, "beta_valu": 0, "beta_vari": 0, "normalize_beta": 0, "refin": 0, "singl": [0, 4], "via": 0, "neighborhood": [0, 1, 6], "index": [0, 4], "sc": [0, 3, 6], "level": 0, "coordin": [0, 7], "obsm": [0, 7], "n": 0, "t": 0, "intens": 0, "identifi": 0, "threshold": 0, "y": 0, "beta": 0, "updat": [0, 2], "elast": 0, "net": 0, "initi": [0, 1, 3, 6], "length": 0, "If": 0, "remain": 0, "throughout": 0, "after": 0, "allow": 0, "like": 0, "step": [0, 4], "within": 0, "chang": [0, 1], "constrain": 0, "vari": 0, "most": 0, "amount": 0, "while": 0, "stai": 0, "specifi": [0, 7], "failur": 0, "deconvolute_spot_with_neighbors_with_prior": 0, "lambda_prior_weight": 0, "its": 0, "both": [0, 7], "cell_type_nam": 0, "initial_y_valu": 0, "initial_beta_valu": 0, "list": 0, "order": 0, "name": 0, "estim": [0, 1, 7], "i": [0, 3, 4], "consist": [0, 7], "decid": 0, "how": [0, 6], "ignor": 0, "loop": 0, "pure": 0, "o": 0, "cpu_count": 0, "new": [0, 2], "obtain": 0, "origin": 0, "interfac": 0, "log_marker_gene_pattern": 0, "zero_pattern": 0, "marker_gen": 0, "log": 0, "map_antibodies_to_profil": 0, "predefin": 0, "t_cell_typ": 0, "ensur": [0, 2], "column": 0, "normalize_count": 0, "exclude_highly_express": 0, "max_fract": 0, "05": 0, "integ": 0, "rel": 0, "exclud": 0, "highli": 0, "fraction": 0, "50": [0, 3, 6, 7], "perform": 0, "y_valu": 0, "optimize_gene_express": 0, "deconvolution_expression_data": 0, "filtered_adata": 0, "guidanc": 0, "sampl": [0, 3], "scale_gen": 0, "expression_matrix": 0, "scale": 0, "independ": 0, "rang": 0, "scaled_matrix": 0, "gene_min": 0, "gene_max": 0, "unscale_gen": 0, "revers": 0, "wise": 0, "transform": 0, "unscal": 0, "validate_prior_effect": 0, "spotwise_profiles_pass2": 0, "compar": 0, "pass1": 0, "pass2": 0, "verifi": [0, 5], "profile_matrix": 0, "second": 0, "m": 0, "metric": [0, 7], "helper": [0, 1], "assert_neighborhood_s": 0, "num_spot": 0, "benchmark_cell_proport": 0, "true_proport": 0, "predicted_proport": 0, "calcul": 0, "predict": 0, "ground": 0, "truth": 0, "correspond": 0, "variou": 0, "calculate_expression_metr": 0, "ground_truth_dir": 0, "predictions_dir": 0, "csv": 0, "method": 0, "nrmse": 0, "look": 0, "specif": [0, 1, 7], "subdirectori": 0, "overal": 0, "cleanup_memori": 0, "forc": 0, "garbag": 0, "collect": 0, "export_anndata_lay": 0, "export": 0, "all": [0, 1, 2], "creat": [0, 2], "folder": 0, "differ": [0, 3], "save": [0, 1], "find_fixed_radius_neighbor": 0, "spot_index": 0, "find": 0, "given": 0, "central": 0, "dataset": 0, "central_spot_nam": 0, "get_neighbors_with_fixed_radiu": 0, "include_cent": 0, "get": [0, 3, 6], "around": 0, "includ": [0, 2], "repres": 0, "plot_neighbors_with_fixed_radiu": 0, "plot": [0, 3], "multipl": [0, 3], "random": 0, "pl": [0, 3], "visual": [0, 4], "displai": 0, "seri": 0, "show": [0, 3], "save_results_to_output": 0, "filepath": 0, "setup_log": 0, "dynam": 0, "validate_cell_profile_dict": 0, "structur": 0, "notabl": 1, "citegeist": [1, 2, 3, 5, 6, 7], "document": [1, 5], "releas": 1, "framework": [1, 4], "gurobi": [1, 3, 4], "comprehens": [1, 2, 7], "incorpor": 1, "inform": [1, 7], "resum": 1, "long": 1, "multi": 1, "support": 1, "model": [1, 3, 4, 6], "util": [1, 4], "checkpointmanag": 1, "manag": 1, "python": [1, 5], "3": [1, 3, 5], "7": [1, 3, 5, 7], "panda": [1, 3, 5], "scanpi": [1, 3, 5, 6], "scipi": [1, 5], "pyarrow": [1, 5], "gurobipi": [1, 5], "requir": [1, 5, 7], "we": 2, "welcom": [2, 4], "guidelin": 2, "project": 2, "fork": 2, "repositori": 2, "github": [2, 5], "clone": [2, 5], "your": [2, 5, 6, 7], "branch": 2, "featur": [2, 7], "bugfix": 2, "make": 2, "add": 2, "pull": 2, "request": 2, "environ": 2, "git": [2, 5], "http": [2, 5], "com": [2, 5], "usernam": 2, "cd": [2, 5], "pip": [2, 5], "instal": [2, 4], "e": [2, 5], "dev": 2, "follow": [2, 5], "pep": 2, "8": [2, 3, 7], "hint": 2, "appropri": 2, "write": 2, "docstr": 2, "unit": 2, "exampl": [2, 4, 6, 7], "tutori": [2, 4, 6], "befor": 2, "integr": 2, "complex": 2, "clear": 2, "descript": 2, "For": [2, 5, 6, 7], "question": 2, "discuss": 2, "pleas": 2, "open": 2, "issu": 2, "section": [3, 6, 7], "practic": 3, "complet": 3, "import": [3, 5, 6], "pd": 3, "read_h5ad": [3, 6], "spatial_data": 3, "h5ad": [3, 6], "brain_section_1": 3, "citegeist_result": 3, "need": [3, 5], "lic": 3, "cell_profil": [3, 6, 7], "neuron": 3, "neun": 3, "9": [3, 7], "map2": 3, "astrocyt": 3, "gfap": 3, "s100b": 3, "microglia": 3, "iba1": 3, "cd68": 3, "6": [3, 7], "oligodendrocyt": 3, "olig2": 3, "mbp": 3, "global_prop": [3, 6, 7], "finetuned_prop": [3, 6, 7], "75": 3, "results_adata": 3, "print": [3, 5], "test": 3, "25": 3, "f": 3, "prop": 3, "_": 3, "evalu": 3, "3f": 3, "sample1": 3, "sample2": 3, "sample3": 3, "same": 3, "abov": 3, "matplotlib": 3, "pyplot": 3, "plt": 3, "fig": 3, "ax": 3, "subplot": 3, "figsiz": 3, "12": 3, "cell_typ": 3, "enumer": 3, "color": 3, "titl": 3, "tight_layout": 3, "combin": 4, "deconvolv": 4, "resolut": 4, "prerequisit": 4, "setup": 4, "verif": 4, "quick": 4, "basic": 4, "usag": 4, "prepar": 4, "overview": 4, "tune": 4, "batch": 4, "implement": 4, "contribut": 4, "changelog": 4, "modul": 4, "search": 4, "higher": 5, "depend": 5, "leeoesterreich": 5, "you": [5, 6], "ll": 5, "system": 5, "packag": 5, "instruct": 5, "see": [5, 6, 7], "To": 5, "successfulli": 5, "guid": [6, 7], "help": 6, "here": 6, "minim": 6, "your_data": 6, "sample_1": 6, "t_cell": [6, 7], "b_cell": [6, 7], "more": [6, 7], "should": 7, "format": 7, "part": 7, "typic": 7, "your_sampl": 7, "your_adata": 7, "cd3": 7, "cd4": 7, "cd19": 7, "cd20": 7, "output": 7, "distribut": 7, "qualiti": 7, "diagnost": 7}, "objects": {"": [[0, 0, 0, "-", "citegeist_model"], [0, 0, 0, "-", "gurobi_impl"], [0, 0, 0, "-", "utils"]], "citegeist_model": [[0, 1, 1, "", "CitegeistModel"]], "citegeist_model.CitegeistModel": [[0, 2, 1, "", "__repr__"], [0, 2, 1, "", "__str__"], [0, 2, 1, "", "append_gex_to_adata"], [0, 2, 1, "", "append_proportions_to_adata"], [0, 2, 1, "", "cleanup"], [0, 2, 1, "", "compute_expression_prior"], [0, 2, 1, "", "copy_gex_to_protein_adata"], [0, 2, 1, "", "filter_gex"], [0, 2, 1, "", "get_adata"], [0, 2, 1, "", "global_clr"], [0, 2, 1, "", "load_cell_profile_dict"], [0, 2, 1, "", "preprocess_antibody"], [0, 2, 1, "", "preprocess_gex"], [0, 2, 1, "", "register_gurobi"], [0, 2, 1, "", "row_normalize"], [0, 2, 1, "", "run_cell_expression_pass1"], [0, 2, 1, "", "run_cell_proportion_model"], [0, 2, 1, "", "split_adata"], [0, 2, 1, "", "validate_neighborhood_size"], [0, 2, 1, "", "winsorize"]], "gurobi_impl": [[0, 3, 1, "", "compute_global_prior"], [0, 3, 1, "", "deconvolute_local_cell_proportions"], [0, 3, 1, "", "deconvolute_spot_with_neighbors_with_prior"], [0, 3, 1, "", "finetune_cell_proportions"], [0, 3, 1, "", "log_marker_gene_patterns"], [0, 3, 1, "", "map_antibodies_to_profiles"], [0, 3, 1, "", "normalize_counts"], [0, 3, 1, "", "optimize_cell_proportions"], [0, 3, 1, "", "optimize_gene_expression"], [0, 3, 1, "", "scale_genes"], [0, 3, 1, "", "unscale_genes"], [0, 3, 1, "", "validate_prior_effect"]], "utils": [[0, 3, 1, "", "assert_neighborhood_size"], [0, 3, 1, "", "benchmark_cell_proportions"], [0, 3, 1, "", "calculate_expression_metrics"], [0, 3, 1, "", "cleanup_memory"], [0, 3, 1, "", "export_anndata_layers"], [0, 3, 1, "", "find_fixed_radius_neighbors"], [0, 3, 1, "", "get_neighbors_with_fixed_radius"], [0, 3, 1, "", "plot_neighbors_with_fixed_radius"], [0, 3, 1, "", "save_results_to_output"], [0, 3, 1, "", "setup_logging"], [0, 3, 1, "", "validate_cell_profile_dict"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"]}, "titleterms": {"api": [0, 1, 4], "refer": [0, 1, 4], "citegeist": [0, 4], "model": [0, 7], "gurobi": [0, 5], "implement": 0, "util": 0, "changelog": 1, "version": 1, "1": [1, 7], "0": 1, "unreleas": 1, "featur": 1, "depend": 1, "contribut": 2, "get": [2, 4], "start": [2, 4, 6], "develop": [2, 4], "setup": [2, 5], "code": 2, "style": 2, "document": [2, 4], "test": 2, "submit": 2, "chang": 2, "exampl": 3, "basic": [3, 6], "analysi": 3, "paramet": [3, 6], "tune": 3, "batch": 3, "process": 3, "visual": 3, "user": 4, "guid": 4, "indic": 4, "tabl": 4, "instal": 5, "prerequisit": 5, "verif": 5, "quick": 6, "usag": 6, "kei": 6, "tutori": 7, "data": 7, "prepar": 7, "workflow": 7, "overview": 7, "detail": 7, "step": 7, "initi": 7, "2": 7, "split": 7, "preprocess": 7, "3": 7, "load": 7, "cell": 7, "type": 7, "profil": 7, "4": 7, "run": 7, "optim": 7, "result": 7}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx.ext.intersphinx": 1, "sphinx": 57}, "alltitles": {"API Reference": [[0, "api-reference"], [1, "api-reference"]], "CITEgeist Model": [[0, "citegeist-model"]], "Gurobi Implementation": [[0, "gurobi-implementation"]], "Utilities": [[0, "utilities"]], "Changelog": [[1, "changelog"]], "Version 1.0.0 (Unreleased)": [[1, "version-1-0-0-unreleased"]], "Features": [[1, "features"]], "Dependencies": [[1, "dependencies"]], "Contributing": [[2, "contributing"]], "Getting Started": [[2, "getting-started"]], "Development Setup": [[2, "development-setup"]], "Code Style": [[2, "code-style"]], "Documentation": [[2, "documentation"]], "Testing": [[2, "testing"]], "Submitting Changes": [[2, "submitting-changes"]], "Examples": [[3, "examples"]], "Basic Analysis": [[3, "basic-analysis"]], "Parameter Tuning": [[3, "parameter-tuning"]], "Batch Processing": [[3, "batch-processing"]], "Visualization": [[3, "visualization"]], "CITEgeist Documentation": [[4, "citegeist-documentation"]], "Getting Started:": [[4, null]], "User Guide:": [[4, null]], "API Reference:": [[4, null]], "Development:": [[4, null]], "Indices and tables": [[4, "indices-and-tables"]], "Installation": [[5, "installation"], [5, "id1"]], "Prerequisites": [[5, "prerequisites"]], "Gurobi Setup": [[5, "gurobi-setup"]], "Verification": [[5, "verification"]], "Quick Start": [[6, "quick-start"]], "Basic Usage": [[6, "basic-usage"]], "Key Parameters": [[6, "key-parameters"]], "Tutorial": [[7, "tutorial"]], "Data Preparation": [[7, "data-preparation"]], "Workflow Overview": [[7, "workflow-overview"]], "Detailed Steps": [[7, "detailed-steps"]], "Step 1: Initialize the Model": [[7, "step-1-initialize-the-model"]], "Step 2: Split and Preprocess Data": [[7, "step-2-split-and-preprocess-data"]], "Step 3: Load Cell Type Profiles": [[7, "step-3-load-cell-type-profiles"]], "Step 4: Run Optimization": [[7, "step-4-run-optimization"]], "Results": [[7, "results"]]}, "indexentries": {}})