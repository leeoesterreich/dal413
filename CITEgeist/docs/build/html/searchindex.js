Search.setIndex({"docnames": ["api", "changelog", "contributing", "examples", "index", "installation", "notebooks", "notebooks/vignette_1_biopsy_heterogeneity", "notebooks/vignette_2_surgical_d538g", "notebooks/vignette_3_responder_macrophages", "notebooks/vignette_4_external_tools", "quickstart", "tutorial"], "filenames": ["api.rst", "changelog.rst", "contributing.rst", "examples.rst", "index.rst", "installation.rst", "notebooks.rst", "notebooks/vignette_1_biopsy_heterogeneity.rst", "notebooks/vignette_2_surgical_d538g.rst", "notebooks/vignette_3_responder_macrophages.rst", "notebooks/vignette_4_external_tools.rst", "quickstart.rst", "tutorial.rst"], "titles": ["API Reference", "Changelog", "Contributing", "Examples", "CITEgeist Documentation", "Installation", "Interactive Tutorials and Vignettes", "Vignette 1: Biopsy Heterogeneity Analysis", "Vignette 2: ESR1 D538G Mutations in Surgical Samples", "Vignette 3: Macrophage Behavior in Responding Patients", "Vignette 4: Integration with External Tools", "Quick Start", "Tutorial"], "terms": {"thi": [0, 1, 2, 3, 6, 7, 8, 9, 10, 11, 12], "page": [0, 4, 6], "provid": [0, 2, 3, 6, 12], "an": [0, 2], "auto": 0, "gener": [0, 7, 8, 9, 10], "summari": 0, "": [0, 4, 7, 8, 9, 10, 11], "public": 0, "The": [0, 5, 7, 8, 9, 12], "main": [0, 1, 12], "class": [0, 1], "spatial": [0, 1, 3, 4, 6, 7, 8, 9, 10, 11, 12], "transcriptom": [0, 1, 3, 4, 6, 7, 8, 10, 11, 12], "analysi": [0, 1, 4, 6, 8, 9, 10, 11, 12], "citegeist_model": [0, 1, 3, 5, 11], "citegeistmodel": [0, 1, 3, 7, 8, 9, 10, 11, 12], "sample_nam": [0, 3, 7, 8, 9, 10, 11, 12], "adata": [0, 3, 7, 8, 9, 10, 11, 12], "none": 0, "output_fold": [0, 3, 7, 8, 9, 10, 11, 12], "simul": 0, "fals": 0, "gene_expression_adata": 0, "antibody_capture_adata": 0, "sourc": [0, 5], "base": [0, 1], "object": 0, "__repr__": 0, "develop": [0, 10], "friendli": 0, "represent": 0, "__str__": 0, "user": 0, "append_gex_to_adata": 0, "parquet_path": 0, "pass_numb": 0, "1": [0, 4, 6, 8, 11], "append": 0, "gene": [0, 1, 4, 6, 7, 8, 9, 11, 12], "express": [0, 1, 4, 6, 7, 8, 9, 11, 12], "layer": [0, 12], "from": [0, 3, 5, 6, 7, 8, 9, 10, 11], "parquet": 0, "file": [0, 1, 7], "back": 0, "append_proportions_to_adata": 0, "proportions_path": 0, "kei": [0, 4], "finetun": 0, "cell": [0, 1, 3, 4, 6, 7, 8, 9, 10, 11], "type": [0, 1, 2, 3, 4, 7, 8, 9, 10, 11], "proport": [0, 1, 3, 4, 7, 8, 9, 11, 12], "anndata": [0, 12], "cleanup": 0, "free": 0, "memori": 0, "clean": 0, "up": [0, 2, 6, 7], "temporari": 0, "data": [0, 1, 3, 4, 7, 8, 9, 10, 11], "compute_expression_prior": 0, "spotwise_profiles_pass1": 0, "cell_type_numbers_arrai": 0, "lambda_prior": 0, "0": [0, 3, 10, 11, 12], "min_expression_threshold": 0, "comput": [0, 4], "global": 0, "prior": 0, "pass": [0, 2], "result": [0, 3, 4, 6, 7, 8, 10, 11], "paramet": [0, 4, 7], "dict": 0, "int": 0, "ndarrai": 0, "dictionari": 0, "map": [0, 7, 8, 9, 12], "spot": [0, 7, 12], "indic": 0, "profil": [0, 1, 3, 4, 9, 11], "matric": 0, "arrai": 0, "n_spot": 0, "t_celltyp": 0, "float": 0, "strength": [0, 11], "influenc": 0, "default": 0, "minimum": 0, "consid": 0, "activ": 0, "return": 0, "global_prior": 0, "np": 0, "shape": 0, "m_gene": 0, "confidence_scor": 0, "expression_pattern": 0, "contain": [0, 6, 8], "detail": [0, 4, 5, 7, 11], "statist": 0, "str": 0, "ani": [0, 6], "copy_gex_to_protein_adata": 0, "copi": 0, "number": [0, 11], "antibodi": [0, 1, 4, 7, 8, 9, 11, 12], "captur": [0, 1, 4, 7, 8, 9, 11, 12], "filter_gex": [0, 3, 7, 8, 11, 12], "nonzero_percentag": [0, 12], "01": [0, 12], "mean_expression_threshold": [0, 12], "min_count": [0, 8], "10": [0, 3], "filter": [0, 10, 12], "defin": [0, 3, 9, 12], "criteria": 0, "have": [0, 6], "A": [0, 3, 5], "count": [0, 12], "least": 0, "2": [0, 3, 4, 6, 9, 10], "mean": [0, 3], "nonzero": 0, "percentag": 0, "where": [0, 2], "must": 0, "valu": [0, 3], "get_adata": [0, 3, 10], "retriev": 0, "intern": 0, "downstream": [0, 7], "static": 0, "global_clr": 0, "matrix": [0, 12], "epsilon": 0, "1e": 0, "06": 0, "appli": [0, 8, 9], "margin": 0, "clr": 0, "normal": [0, 12], "geometr": 0, "per": 0, "marker": 0, "param": 0, "input": 0, "x": 0, "numpi": [0, 1, 5], "small": 0, "constant": 0, "avoid": 0, "divis": 0, "zero": 0, "load_cell_profile_dict": [0, 3, 11, 12], "cell_profile_dict": 0, "load": [0, 3, 7, 8, 10, 11], "valid": [0, 5, 6, 8, 10], "preprocess_antibodi": [0, 3, 7, 8, 11, 12], "preprocess": [0, 7, 11], "winsor": 0, "extrem": 0, "gaussian": 0, "smooth": 0, "local": [0, 2, 6, 7, 8, 9, 10], "background": 0, "correct": 0, "rais": 0, "error": 0, "nan": 0, "inf": 0, "ar": [0, 6], "detect": 0, "process": [0, 1, 4, 7, 8, 9, 10], "preprocess_gex": [0, 3, 7, 8, 11, 12], "target_sum": [0, 12], "10000": [0, 12], "preserv": 0, "register_gurobi": [0, 3], "license_file_path": 0, "configur": [0, 3, 6, 7, 8, 9, 10], "set": [0, 2, 6, 7], "onli": 0, "licens": [0, 1, 5, 7, 8, 9, 10], "path": [0, 3, 6, 7, 8, 9], "row_norm": 0, "row": 0, "2d": 0, "fix": 0, "target": 0, "sum": 0, "run_cell_expression_pass1": [0, 3, 11, 12], "radiu": [0, 3, 7, 8, 11, 12], "alpha": [0, 3, 11, 12], "5": [0, 3, 8, 12], "lambda_reg_gex": 0, "001": 0, "global_enrichment_weight": 0, "local_enrichment_weight": 0, "max_work": [0, 11], "checkpoint_interv": 0, "100": [0, 3], "output_dir": 0, "checkpoint": [0, 1], "rerun": 0, "true": 0, "run": [0, 1, 3, 6, 11], "first": 0, "deconvolut": [0, 1, 6, 8, 11, 12], "neighbor": 0, "weight": 0, "regular": [0, 1, 11], "enrich": [0, 8], "option": 0, "maximum": 0, "parallel": [0, 1, 11], "worker": [0, 11], "between": [0, 8, 9], "directori": 0, "bool": 0, "whether": 0, "exist": [0, 2], "spotwise_profil": 0, "dimens": 0, "tupl": 0, "run_cell_proportion_model": [0, 3, 7, 8, 11, 12], "toler": 0, "0001": 0, "max_iter": 0, "20": 0, "lambda_reg": [0, 3, 11, 12], "max_y_chang": 0, "4": [0, 4, 6, 9], "orchestr": 0, "optim": [0, 1, 3, 5, 11], "workflow": [0, 2, 3, 4, 6, 7, 8, 9, 10], "deleg": 0, "optimize_cell_proport": 0, "finetune_cell_proport": 0, "gurobi_impl": [0, 1], "py": 0, "converg": 0, "em": 0, "algorithm": 0, "iter": 0, "l1": [0, 11], "l2": [0, 11], "tradeoff": [0, 11], "factor": [0, 11], "dure": 0, "split_adata": [0, 3, 7, 11, 12], "split": [0, 7, 9, 11], "separ": [0, 12], "sub": 0, "feature_typ": [0, 12], "var": [0, 12], "validate_neighborhood_s": 0, "lower_percentil": 0, "upper_percentil": 0, "95": 0, "core": [0, 1, 6, 9], "function": [0, 1, 2], "us": [0, 1, 2, 3, 5, 6, 7, 10, 11, 12], "solver": 0, "compute_global_prior": 0, "spotwise_gene_expression_profil": 0, "pattern": [0, 6, 7, 8, 9], "confid": 0, "each": [0, 6, 7, 12], "deconvolute_local_cell_proport": 0, "spot_idx": 0, "profile_based_antibody_data": 0, "beta_valu": 0, "beta_vari": 0, "normalize_beta": 0, "refin": 0, "singl": [0, 4], "via": 0, "neighborhood": [0, 1, 7, 11], "index": [0, 4], "sc": [0, 3, 11], "level": 0, "coordin": [0, 7, 8, 9, 12], "obsm": [0, 12], "n": 0, "t": 0, "intens": 0, "identifi": 0, "threshold": [0, 8, 10], "y": 0, "beta": 0, "updat": [0, 2, 6], "elast": 0, "net": 0, "initi": [0, 1, 3, 7, 8, 11], "length": 0, "If": 0, "remain": 0, "throughout": 0, "after": [0, 7, 8, 9, 10], "allow": 0, "like": 0, "step": [0, 4, 6], "within": [0, 6, 7], "chang": [0, 1], "constrain": 0, "vari": 0, "most": 0, "amount": 0, "while": 0, "stai": 0, "specifi": [0, 12], "failur": 0, "deconvolute_spot_with_neighbors_with_prior": 0, "lambda_prior_weight": 0, "its": 0, "both": [0, 12], "cell_type_nam": 0, "initial_y_valu": 0, "initial_beta_valu": 0, "list": 0, "order": 0, "name": 0, "estim": [0, 1, 7, 12], "i": [0, 3, 4], "consist": [0, 12], "decid": 0, "how": [0, 6, 7, 8, 9, 10, 11], "ignor": 0, "loop": 0, "pure": 0, "o": [0, 7, 8, 9], "cpu_count": 0, "new": [0, 2], "obtain": 0, "origin": 0, "interfac": 0, "log_marker_gene_pattern": 0, "zero_pattern": 0, "marker_gen": 0, "log": 0, "map_antibodies_to_profil": 0, "predefin": 0, "t_cell_typ": 0, "ensur": [0, 2, 6], "column": 0, "normalize_count": 0, "exclude_highly_express": 0, "max_fract": 0, "05": 0, "integ": 0, "rel": 0, "exclud": 0, "highli": 0, "fraction": 0, "50": [0, 3, 7, 11, 12], "perform": 0, "y_valu": 0, "optimize_gene_express": 0, "deconvolution_expression_data": 0, "filtered_adata": 0, "guidanc": 0, "sampl": [0, 3, 4, 6, 7, 9, 10], "scale_gen": 0, "expression_matrix": 0, "scale": 0, "independ": 0, "rang": 0, "scaled_matrix": 0, "gene_min": 0, "gene_max": 0, "unscale_gen": 0, "revers": 0, "wise": 0, "transform": 0, "unscal": 0, "validate_prior_effect": 0, "spotwise_profiles_pass2": 0, "compar": [0, 6, 8, 9], "pass1": 0, "pass2": 0, "verifi": [0, 5], "profile_matrix": 0, "second": 0, "m": 0, "metric": [0, 7, 12], "helper": [0, 1], "assert_neighborhood_s": 0, "num_spot": 0, "benchmark_cell_proport": 0, "true_proport": 0, "predicted_proport": 0, "calcul": 0, "predict": 0, "ground": 0, "truth": 0, "correspond": 0, "variou": [0, 6, 10], "calculate_expression_metr": 0, "ground_truth_dir": 0, "predictions_dir": 0, "csv": 0, "method": [0, 7, 8, 9, 10], "nrmse": 0, "look": 0, "specif": [0, 1, 12], "subdirectori": 0, "overal": 0, "cleanup_memori": 0, "forc": 0, "garbag": 0, "collect": 0, "export_anndata_lay": 0, "export": [0, 10], "all": [0, 1, 2, 6, 9], "creat": [0, 2], "folder": [0, 7], "differ": [0, 3, 7, 8, 9, 10], "save": [0, 1], "find_fixed_radius_neighbor": 0, "spot_index": 0, "find": [0, 7], "given": 0, "central": 0, "dataset": [0, 6, 7, 9], "central_spot_nam": 0, "get_neighbors_with_fixed_radiu": 0, "include_cent": 0, "get": [0, 3, 11], "around": 0, "includ": [0, 2], "repres": 0, "plot_neighbors_with_fixed_radiu": 0, "plot": [0, 3, 7, 8], "multipl": [0, 3, 9, 10], "random": 0, "pl": [0, 3], "visual": [0, 4, 7, 8, 9, 10], "displai": 0, "seri": 0, "show": [0, 3, 6, 7, 10], "save_results_to_output": 0, "filepath": 0, "setup_log": 0, "dynam": 0, "validate_cell_profile_dict": 0, "structur": 0, "notabl": 1, "citegeist": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12], "document": [1, 5], "releas": 1, "framework": [1, 4], "gurobi": [1, 3, 4, 6, 7, 8, 9, 10], "comprehens": [1, 2, 6, 7, 8, 9, 10, 12], "incorpor": 1, "inform": [1, 6, 12], "resum": 1, "long": 1, "multi": [1, 9, 10], "support": 1, "model": [1, 3, 4, 7, 8, 9, 10, 11], "util": [1, 4], "checkpointmanag": 1, "manag": 1, "python": [1, 5, 6, 7, 8, 9, 10], "3": [1, 3, 4, 5, 6, 8, 10], "7": [1, 3, 5, 12], "panda": [1, 3, 5, 8, 9, 10], "scanpi": [1, 3, 5, 7, 8, 9, 10, 11], "scipi": [1, 5], "pyarrow": [1, 5], "gurobipi": [1, 5], "requir": [1, 4, 5, 7, 8, 9, 10, 12], "we": [2, 7], "welcom": [2, 4], "guidelin": [2, 10], "project": 2, "fork": 2, "repositori": 2, "github": [2, 5], "clone": [2, 5], "your": [2, 5, 6, 7, 8, 9, 10, 11, 12], "branch": 2, "featur": [2, 7, 12], "bugfix": 2, "make": [2, 6], "add": 2, "pull": 2, "request": 2, "environ": [2, 6], "git": [2, 5], "http": [2, 5], "com": [2, 5], "usernam": 2, "cd": [2, 5], "pip": [2, 5], "instal": [2, 4, 6, 7, 8, 9, 10], "e": [2, 5], "dev": 2, "follow": [2, 5, 6], "pep": 2, "8": [2, 3, 12], "hint": 2, "appropri": 2, "write": 2, "docstr": 2, "unit": 2, "exampl": [2, 4, 6, 11, 12], "tutori": [2, 4, 7, 8, 9, 10, 11], "befor": 2, "integr": [2, 4, 6, 8, 9], "complex": 2, "clear": 2, "descript": [2, 4], "For": [2, 5, 6, 11, 12], "question": 2, "discuss": 2, "pleas": 2, "open": 2, "issu": 2, "section": [3, 6, 11, 12], "practic": 3, "complet": [3, 7, 8, 9, 10], "import": [3, 5, 7, 11], "pd": 3, "read_h5ad": [3, 11], "spatial_data": 3, "h5ad": [3, 11], "brain_section_1": 3, "citegeist_result": 3, "need": [3, 5], "lic": 3, "cell_profil": [3, 11, 12], "neuron": 3, "neun": 3, "9": [3, 12], "map2": 3, "astrocyt": 3, "gfap": 3, "s100b": 3, "microglia": 3, "iba1": 3, "cd68": 3, "6": [3, 12], "oligodendrocyt": 3, "olig2": 3, "mbp": 3, "global_prop": [3, 7, 11, 12], "finetuned_prop": [3, 7, 8, 11, 12], "75": [3, 8], "results_adata": [3, 10], "print": [3, 5], "test": 3, "25": 3, "f": [3, 9], "prop": [3, 8], "_": 3, "evalu": 3, "3f": 3, "sample1": 3, "sample2": 3, "sample3": 3, "same": [3, 9], "abov": 3, "matplotlib": [3, 7, 8, 9, 10], "pyplot": 3, "plt": 3, "fig": 3, "ax": 3, "subplot": 3, "figsiz": 3, "12": 3, "cell_typ": [3, 10], "enumer": 3, "color": 3, "titl": 3, "tight_layout": 3, "combin": [4, 6, 8], "deconvolv": 4, "resolut": 4, "prerequisit": [4, 7, 8, 9, 10], "setup": 4, "verif": 4, "quick": 4, "basic": [4, 8], "usag": 4, "prepar": [4, 6, 7, 10], "overview": 4, "tune": 4, "batch": 4, "interact": [4, 7, 8, 9, 10], "vignett": 4, "biopsi": [4, 6, 8, 9], "heterogen": [4, 6, 8], "esr1": [4, 6, 9], "d538g": [4, 6, 9], "mutat": [4, 6, 9], "surgic": [4, 6, 9], "macrophag": [4, 6, 8, 10], "behavior": [4, 6, 8, 10], "respond": [4, 6, 8, 10], "patient": [4, 6, 8, 10], "extern": [4, 6, 9], "tool": [4, 6, 9], "notebook": [4, 7, 8, 9, 10], "implement": 4, "contribut": [4, 10], "changelog": 4, "modul": 4, "search": 4, "higher": 5, "depend": [5, 6], "leeoesterreich": 5, "you": [5, 6, 7, 8, 9, 10, 11], "ll": [5, 7], "system": 5, "packag": [5, 6, 7, 8, 9, 10], "instruct": 5, "see": [5, 6, 7, 8, 9, 10, 11, 12], "To": [5, 6], "successfulli": 5, "jupyt": 6, "demonstr": [6, 7, 8, 10], "aspect": 6, "These": 6, "hand": 6, "can": 6, "download": 6, "guid": [6, 7, 8, 9, 10, 11, 12], "click": 6, "button": 6, "execut": 6, "analyz": [6, 7, 8, 9], "cancer": [6, 7, 8], "explor": [6, 7, 8, 9, 10], "cellular": [6, 7], "tumor": [6, 7, 9], "microenviron": [6, 7], "visium": [6, 7], "pathwai": [6, 8], "signatur": [6, 8], "examin": [6, 9], "popul": [6, 9], "specimen": [6, 8, 9], "focus": [6, 9], "distribut": [6, 7, 9, 12], "associ": [6, 8, 9], "tam": [6, 9], "should": [6, 12], "avail": 6, "sure": 6, "data_fold": [6, 7, 8, 9], "point": 6, "license_fil": 6, "more": [6, 9, 11, 12], "about": 6, "cover": [7, 8, 9, 10], "interpret": 7, "understand": [7, 8, 9, 10], "select": 7, "own": [7, 8, 9, 10], "vignette_1_biopsy_heterogen": 7, "ipynb": [7, 8, 9, 10], "squidpi": [7, 10], "seaborn": [7, 8, 9], "properli": 7, "format": [7, 10, 12], "here": [7, 8, 9, 10, 11], "preview": [7, 8, 9, 10], "path_to_visium_fold": 7, "join": [7, 8, 9], "hcc22": [7, 9], "088": [7, 9], "p1": 7, "s2": [7, 9], "out": [7, 8, 9], "biopsy_sampl": 7, "qualiti": [7, 10, 12], "diagnost": [7, 12], "try": [7, 8, 9], "experi": 7, "other": [7, 9, 10], "advanc": [7, 8], "analys": 7, "check": 7, "explan": 7, "addit": [7, 9], "api": [7, 8, 9, 10], "refer": [7, 8, 9, 10], "common": 8, "breast": 8, "known": 8, "comparison": [8, 9], "posit": 8, "neg": 8, "region": 8, "techniqu": [8, 9], "approach": [8, 9], "context": 8, "vignette_2_surgical_d538g": 8, "annot": [8, 9, 10], "statu": 8, "tissu": 8, "morphologi": 8, "surgical_data_path": 8, "surgical_sampl": 8, "surgical_d538g": 8, "surgical_adata": 8, "surgical_result": 8, "lower": 8, "clinic": [8, 9], "outcom": 8, "subtyp": 9, "respons": 9, "v": 9, "immun": 9, "vignette_3_responder_macrophag": 9, "biopsy_responding_path": 9, "p2": 9, "s1": 9, "p3": 9, "s1_a": 9, "surg_responding_path": 9, "sample_path": 9, "biopsy_": 9, "load_sampl": 9, "macrophage_analysi": 9, "correl": 9, "variabl": 9, "It": 10, "them": 10, "popular": 10, "bioinformat": 10, "commun": 10, "commot": 10, "convers": 10, "compat": 10, "strategi": 10, "control": 10, "build": 10, "vignette_4_external_tool": 10, "etc": 10, "ligand": 10, "receptor": 10, "databas": 10, "integration_exampl": 10, "processed_adata": 10, "integration_result": 10, "merg": 10, "merged_adata": 10, "merge_celltyp": 10, "sq": 10, "gr": 10, "ligrec": 10, "n_perm": 10, "1000": 10, "cluster_kei": 10, "report": 10, "custom": 10, "pipelin": 10, "autom": 10, "share": 10, "help": 11, "minim": 11, "your_data": 11, "sample_1": 11, "t_cell": [11, 12], "b_cell": [11, 12], "part": 12, "typic": 12, "your_sampl": 12, "your_adata": 12, "cd3": 12, "cd4": 12, "cd19": 12, "cd20": 12, "output": 12}, "objects": {"": [[0, 0, 0, "-", "citegeist_model"], [0, 0, 0, "-", "gurobi_impl"], [0, 0, 0, "-", "utils"]], "citegeist_model": [[0, 1, 1, "", "CitegeistModel"]], "citegeist_model.CitegeistModel": [[0, 2, 1, "", "__repr__"], [0, 2, 1, "", "__str__"], [0, 2, 1, "", "append_gex_to_adata"], [0, 2, 1, "", "append_proportions_to_adata"], [0, 2, 1, "", "cleanup"], [0, 2, 1, "", "compute_expression_prior"], [0, 2, 1, "", "copy_gex_to_protein_adata"], [0, 2, 1, "", "filter_gex"], [0, 2, 1, "", "get_adata"], [0, 2, 1, "", "global_clr"], [0, 2, 1, "", "load_cell_profile_dict"], [0, 2, 1, "", "preprocess_antibody"], [0, 2, 1, "", "preprocess_gex"], [0, 2, 1, "", "register_gurobi"], [0, 2, 1, "", "row_normalize"], [0, 2, 1, "", "run_cell_expression_pass1"], [0, 2, 1, "", "run_cell_proportion_model"], [0, 2, 1, "", "split_adata"], [0, 2, 1, "", "validate_neighborhood_size"], [0, 2, 1, "", "winsorize"]], "gurobi_impl": [[0, 3, 1, "", "compute_global_prior"], [0, 3, 1, "", "deconvolute_local_cell_proportions"], [0, 3, 1, "", "deconvolute_spot_with_neighbors_with_prior"], [0, 3, 1, "", "finetune_cell_proportions"], [0, 3, 1, "", "log_marker_gene_patterns"], [0, 3, 1, "", "map_antibodies_to_profiles"], [0, 3, 1, "", "normalize_counts"], [0, 3, 1, "", "optimize_cell_proportions"], [0, 3, 1, "", "optimize_gene_expression"], [0, 3, 1, "", "scale_genes"], [0, 3, 1, "", "unscale_genes"], [0, 3, 1, "", "validate_prior_effect"]], "utils": [[0, 3, 1, "", "assert_neighborhood_size"], [0, 3, 1, "", "benchmark_cell_proportions"], [0, 3, 1, "", "calculate_expression_metrics"], [0, 3, 1, "", "cleanup_memory"], [0, 3, 1, "", "export_anndata_layers"], [0, 3, 1, "", "find_fixed_radius_neighbors"], [0, 3, 1, "", "get_neighbors_with_fixed_radius"], [0, 3, 1, "", "plot_neighbors_with_fixed_radius"], [0, 3, 1, "", "save_results_to_output"], [0, 3, 1, "", "setup_logging"], [0, 3, 1, "", "validate_cell_profile_dict"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"]}, "titleterms": {"api": [0, 1, 4], "refer": [0, 1, 4], "citegeist": [0, 4], "model": [0, 12], "gurobi": [0, 5], "implement": 0, "util": 0, "changelog": 1, "version": 1, "1": [1, 7, 12], "0": 1, "unreleas": 1, "featur": 1, "depend": 1, "contribut": 2, "get": [2, 4, 6], "start": [2, 4, 6, 11], "develop": [2, 4], "setup": [2, 5], "code": [2, 7, 8, 9, 10], "style": 2, "document": [2, 4, 7, 8, 9, 10], "test": 2, "submit": 2, "chang": 2, "exampl": [3, 7, 8, 9, 10], "basic": [3, 11], "analysi": [3, 7], "paramet": [3, 11], "tune": 3, "batch": 3, "process": 3, "visual": 3, "user": 4, "guid": 4, "indic": 4, "tabl": 4, "instal": 5, "prerequisit": 5, "verif": 5, "interact": 6, "tutori": [6, 12], "vignett": [6, 7, 8, 9, 10], "notebook": 6, "descript": 6, "data": [6, 12], "requir": 6, "biopsi": 7, "heterogen": 7, "overview": [7, 8, 9, 10, 12], "kei": [7, 8, 9, 10, 11], "learn": [7, 8, 9, 10], "object": [7, 8, 9, 10], "download": [7, 8, 9, 10], "run": [7, 8, 9, 10, 12], "expect": [7, 8, 9, 10], "output": [7, 8, 9, 10], "next": [7, 8, 9, 10], "step": [7, 8, 9, 10, 12], "relat": [7, 8, 9, 10], "2": [8, 12], "esr1": 8, "d538g": 8, "mutat": 8, "surgic": 8, "sampl": 8, "3": [9, 12], "macrophag": 9, "behavior": 9, "respond": 9, "patient": 9, "4": [10, 12], "integr": 10, "extern": 10, "tool": 10, "quick": 11, "usag": 11, "prepar": 12, "workflow": 12, "detail": 12, "initi": 12, "split": 12, "preprocess": 12, "load": 12, "cell": 12, "type": 12, "profil": 12, "optim": 12, "result": 12}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx.ext.intersphinx": 1, "sphinx": 57}, "alltitles": {"API Reference": [[0, "api-reference"], [1, "api-reference"]], "CITEgeist Model": [[0, "citegeist-model"]], "Gurobi Implementation": [[0, "gurobi-implementation"]], "Utilities": [[0, "utilities"]], "Changelog": [[1, "changelog"]], "Version 1.0.0 (Unreleased)": [[1, "version-1-0-0-unreleased"]], "Features": [[1, "features"]], "Dependencies": [[1, "dependencies"]], "Contributing": [[2, "contributing"]], "Getting Started": [[2, "getting-started"]], "Development Setup": [[2, "development-setup"]], "Code Style": [[2, "code-style"]], "Documentation": [[2, "documentation"]], "Testing": [[2, "testing"]], "Submitting Changes": [[2, "submitting-changes"]], "Examples": [[3, "examples"]], "Basic Analysis": [[3, "basic-analysis"]], "Parameter Tuning": [[3, "parameter-tuning"]], "Batch Processing": [[3, "batch-processing"]], "Visualization": [[3, "visualization"]], "CITEgeist Documentation": [[4, "citegeist-documentation"]], "Getting Started:": [[4, null]], "User Guide:": [[4, null]], "API Reference:": [[4, null]], "Development:": [[4, null]], "Indices and tables": [[4, "indices-and-tables"]], "Installation": [[5, "installation"], [5, "id1"]], "Prerequisites": [[5, "prerequisites"]], "Gurobi Setup": [[5, "gurobi-setup"]], "Verification": [[5, "verification"]], "Interactive Tutorials and Vignettes": [[6, "interactive-tutorials-and-vignettes"]], "Tutorial Notebooks:": [[6, null]], "Getting Started with Notebooks": [[6, "getting-started-with-notebooks"]], "Notebook Descriptions": [[6, "notebook-descriptions"]], "Data Requirements": [[6, "data-requirements"]], "Vignette 1: Biopsy Heterogeneity Analysis": [[7, "vignette-1-biopsy-heterogeneity-analysis"]], "Overview": [[7, "overview"], [8, "overview"], [9, "overview"], [10, "overview"]], "Key Learning Objectives": [[7, "key-learning-objectives"], [8, "key-learning-objectives"], [9, "key-learning-objectives"], [10, "key-learning-objectives"]], "Download and Run": [[7, "download-and-run"], [8, "download-and-run"], [9, "download-and-run"], [10, "download-and-run"]], "Code Example": [[7, "code-example"], [8, "code-example"], [9, "code-example"], [10, "code-example"]], "Expected Outputs": [[7, "expected-outputs"], [8, "expected-outputs"], [9, "expected-outputs"], [10, "expected-outputs"]], "Next Steps": [[7, "next-steps"], [8, "next-steps"], [9, "next-steps"], [10, "next-steps"]], "Related Documentation": [[7, "related-documentation"], [8, "related-documentation"], [9, "related-documentation"], [10, "related-documentation"]], "Vignette 2: ESR1 D538G Mutations in Surgical Samples": [[8, "vignette-2-esr1-d538g-mutations-in-surgical-samples"]], "Vignette 3: Macrophage Behavior in Responding Patients": [[9, "vignette-3-macrophage-behavior-in-responding-patients"]], "Vignette 4: Integration with External Tools": [[10, "vignette-4-integration-with-external-tools"]], "Quick Start": [[11, "quick-start"]], "Basic Usage": [[11, "basic-usage"]], "Key Parameters": [[11, "key-parameters"]], "Tutorial": [[12, "tutorial"]], "Data Preparation": [[12, "data-preparation"]], "Workflow Overview": [[12, "workflow-overview"]], "Detailed Steps": [[12, "detailed-steps"]], "Step 1: Initialize the Model": [[12, "step-1-initialize-the-model"]], "Step 2: Split and Preprocess Data": [[12, "step-2-split-and-preprocess-data"]], "Step 3: Load Cell Type Profiles": [[12, "step-3-load-cell-type-profiles"]], "Step 4: Run Optimization": [[12, "step-4-run-optimization"]], "Results": [[12, "results"]]}, "indexentries": {"citegeistmodel (class in citegeist_model)": [[0, "citegeist_model.CitegeistModel"]], "__repr__() (citegeist_model.citegeistmodel method)": [[0, "citegeist_model.CitegeistModel.__repr__"]], "__str__() (citegeist_model.citegeistmodel method)": [[0, "citegeist_model.CitegeistModel.__str__"]], "append_gex_to_adata() (citegeist_model.citegeistmodel method)": [[0, "citegeist_model.CitegeistModel.append_gex_to_adata"]], "append_proportions_to_adata() (citegeist_model.citegeistmodel method)": [[0, "citegeist_model.CitegeistModel.append_proportions_to_adata"]], "assert_neighborhood_size() (in module utils)": [[0, "utils.assert_neighborhood_size"]], "benchmark_cell_proportions() (in module utils)": [[0, "utils.benchmark_cell_proportions"]], "calculate_expression_metrics() (in module utils)": [[0, "utils.calculate_expression_metrics"]], "citegeist_model": [[0, "module-citegeist_model"]], "cleanup() (citegeist_model.citegeistmodel method)": [[0, "citegeist_model.CitegeistModel.cleanup"]], "cleanup_memory() (in module utils)": [[0, "utils.cleanup_memory"]], "compute_expression_prior() (citegeist_model.citegeistmodel method)": [[0, "citegeist_model.CitegeistModel.compute_expression_prior"]], "compute_global_prior() (in module gurobi_impl)": [[0, "gurobi_impl.compute_global_prior"]], "copy_gex_to_protein_adata() (citegeist_model.citegeistmodel method)": [[0, "citegeist_model.CitegeistModel.copy_gex_to_protein_adata"]], "deconvolute_local_cell_proportions() (in module gurobi_impl)": [[0, "gurobi_impl.deconvolute_local_cell_proportions"]], "deconvolute_spot_with_neighbors_with_prior() (in module gurobi_impl)": [[0, "gurobi_impl.deconvolute_spot_with_neighbors_with_prior"]], "export_anndata_layers() (in module utils)": [[0, "utils.export_anndata_layers"]], "filter_gex() (citegeist_model.citegeistmodel method)": [[0, "citegeist_model.CitegeistModel.filter_gex"]], "find_fixed_radius_neighbors() (in module utils)": [[0, "utils.find_fixed_radius_neighbors"]], "finetune_cell_proportions() (in module gurobi_impl)": [[0, "gurobi_impl.finetune_cell_proportions"]], "get_adata() (citegeist_model.citegeistmodel method)": [[0, "citegeist_model.CitegeistModel.get_adata"]], "get_neighbors_with_fixed_radius() (in module utils)": [[0, "utils.get_neighbors_with_fixed_radius"]], "global_clr() (citegeist_model.citegeistmodel static method)": [[0, "citegeist_model.CitegeistModel.global_clr"]], "gurobi_impl": [[0, "module-gurobi_impl"]], "load_cell_profile_dict() (citegeist_model.citegeistmodel method)": [[0, "citegeist_model.CitegeistModel.load_cell_profile_dict"]], "log_marker_gene_patterns() (in module gurobi_impl)": [[0, "gurobi_impl.log_marker_gene_patterns"]], "map_antibodies_to_profiles() (in module gurobi_impl)": [[0, "gurobi_impl.map_antibodies_to_profiles"]], "module": [[0, "module-citegeist_model"], [0, "module-gurobi_impl"], [0, "module-utils"]], "normalize_counts() (in module gurobi_impl)": [[0, "gurobi_impl.normalize_counts"]], "optimize_cell_proportions() (in module gurobi_impl)": [[0, "gurobi_impl.optimize_cell_proportions"]], "optimize_gene_expression() (in module gurobi_impl)": [[0, "gurobi_impl.optimize_gene_expression"]], "plot_neighbors_with_fixed_radius() (in module utils)": [[0, "utils.plot_neighbors_with_fixed_radius"]], "preprocess_antibody() (citegeist_model.citegeistmodel method)": [[0, "citegeist_model.CitegeistModel.preprocess_antibody"]], "preprocess_gex() (citegeist_model.citegeistmodel method)": [[0, "citegeist_model.CitegeistModel.preprocess_gex"]], "register_gurobi() (citegeist_model.citegeistmodel method)": [[0, "citegeist_model.CitegeistModel.register_gurobi"]], "row_normalize() (citegeist_model.citegeistmodel static method)": [[0, "citegeist_model.CitegeistModel.row_normalize"]], "run_cell_expression_pass1() (citegeist_model.citegeistmodel method)": [[0, "citegeist_model.CitegeistModel.run_cell_expression_pass1"]], "run_cell_proportion_model() (citegeist_model.citegeistmodel method)": [[0, "citegeist_model.CitegeistModel.run_cell_proportion_model"]], "save_results_to_output() (in module utils)": [[0, "utils.save_results_to_output"]], "scale_genes() (in module gurobi_impl)": [[0, "gurobi_impl.scale_genes"]], "setup_logging() (in module utils)": [[0, "utils.setup_logging"]], "split_adata() (citegeist_model.citegeistmodel method)": [[0, "citegeist_model.CitegeistModel.split_adata"]], "unscale_genes() (in module gurobi_impl)": [[0, "gurobi_impl.unscale_genes"]], "utils": [[0, "module-utils"]], "validate_cell_profile_dict() (in module utils)": [[0, "utils.validate_cell_profile_dict"]], "validate_neighborhood_size() (citegeist_model.citegeistmodel method)": [[0, "citegeist_model.CitegeistModel.validate_neighborhood_size"]], "validate_prior_effect() (in module gurobi_impl)": [[0, "gurobi_impl.validate_prior_effect"]], "winsorize() (citegeist_model.citegeistmodel static method)": [[0, "citegeist_model.CitegeistModel.winsorize"]]}})